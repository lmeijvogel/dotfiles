#!/bin/bash

PATH_AND_FILES=`ruby $(which _sp.rb) $@`

# Currently only works for the first group of files.
path=$(echo  $PATH_AND_FILES | cut -f1 -d\|)
files=$(echo $PATH_AND_FILES | cut -f2 -d\|)

if [ "$PATH_AND_FILES" == "NOT FOUND" ]; then
  echo "ERROR: no file found!"
  exit 1
else
  command="pushd $path >/dev/null ; bundle exec rspec --color $files ; popd >/dev/null"
  echo "-> $command"
  echo

  pushd $path >/dev/null ; bundle exec rspec --color $files
  status=$?
  popd >/dev/null
  exit $status
fi
